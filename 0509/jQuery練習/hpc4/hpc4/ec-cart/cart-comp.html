<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>ECサイトの買い物かご</title>
<link rel="stylesheet" href="style.css">
</head>
<body class="wrapper">

<h1>カートに入っている商品</h1>
<p id="explain-text">ご注文ありがとうございます。下記の項目をご入力ください。</p>

<form action="sample.php" method="post">
<table id="item-table">
  <tr id="item-title">
    <th class="tleft">商品名</th>
    <th>価格(税込)</th>
    <th>個数</th>
    <th>小計</th>
  </tr>
  <tr id="item1">
    <td class="tleft">厳選 生ジェラート</td>
    <td><span id="js-price1">0</span>円</td>
    <td><input type="number" max="20" min="0" value="0" id="js-num1" class="js-calc">個</td>
    <td><span id="js-subtotal1">0</span>円</td>
  </tr>
  <tr id="item2">
    <td class="tleft">果肉いっぱい アイスキャンディ</td>
    <td><span id="js-price2">0</span>円</td>
    <td><input type="number" max="20" min="0" value="0" id="js-num2" class="js-calc">個</td>
    <td><span id="js-subtotal2">0</span>円</td>
  </tr>
</table>
<div id="output_total">
  <div id="subtotalAll"><p>商品代金</p><p><span id="js-subtotalAll">0</span>円</p></div>
  <div id="delivery"><p>送料</p><p><span id="js-delivery">0</span>円</p></div>
  <p id="explain-delivery">2000円以上で送料無料</p>
</div>
<p id="payment">合計：<span id="js-payment">0</span>円</p>
</form>
<ul>
  <li id="purchase"><a href="#">購入に進む</a></li>
  <li id="shopping"><a href="#">買い物を続ける</a></li>
</ul>


<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
<script>
$(function(){

  var price1 = 500; //税込み価格を定義
  var price2 = 400; //税込み価格を定義
  var delivery = 500; //送料
  var num1,subtotal1,num2,subtotal2,subtotalAll,payment;

  $("#js-price1").text(price1);
  $("#js-price2").text(price2);

  $(".js-calc").on("change",function(){
      //購入する個数の取得
      num1 = $("#js-num1").val();
      num2 = $("#js-num2").val();

      //小計の計算と表示
      subtotal1 = price1 * num1;
      subtotal2 = price2 * num2;
      $("#js-subtotal1").text(subtotal1);
      $("#js-subtotal2").text(subtotal2);

      //商品合計の計算
      subtotalAll = subtotal1 + subtotal2;
      $("#js-subtotalAll").text(subtotalAll);

      //2000円未満の場合
      if(subtotalAll < 2000){
        $("#js-delivery").text(delivery);
        payment = subtotalAll + delivery;
      //2000円以上の場合
      }else{
        $("#js-delivery").text(0);
        payment = subtotalAll;
      }
      $("#js-payment").text(payment);
  });
});
</script>
</body>
</html>
